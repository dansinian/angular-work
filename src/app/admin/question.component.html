<div class="admin">
  <app-navigation></app-navigation>
  <div class="admin-right">
    <app-header></app-header>
    <div class="content">
      <div class="content-search">
        <input nz-input style="width: 250px;" placeholder="请输入关键字查询" [(ngModel)]="searchValue">
        <button nz-button nzType="primary" (click)="getSearchInfo()"><i nz-icon type="search" theme="outline"></i> 查询</button>
        <!-- <button nz-button nzType="primary" (click)="addInfo()"><i nz-icon type="plus" theme="outline"></i>添加</button> -->
      </div>
      <div class="content-table">
        <nz-table #nzTable [nzData]="infoList" nzBordered [nzPageSize]="6" nzShowSizeChanger [nzNoResult]="" [nzLoading]="pageLoading">
          <thead>
            <tr>
              <th>序号</th>
              <th>编号</th>
              <th>主题</th>
              <th>内容</th>
              <th>图片</th>
              <th>创建人编号</th>
              <th>创建时间</th>
              <th>隶属课程</th>
              <th>点击量</th>
              <th>点赞数</th>
              <th>回复数</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of nzTable.data; index as i;">
              <td>{{i+1}}</td>
              <td>{{item.queId}}</td>
              <td>{{item.queTitle}}</td>
              <td class="tableOver" title="{{item.queDetail}}">{{item.queDetail}}</td>
              <td><img *ngIf="item.queImg !== '' && item.queImg !== undefined" [src]="item.queImg">
                  <img *ngIf="item.queImg === '' || item.queImg === undefined" src="../assets/image/white.png"></td>
              <td>{{item.userId}}</td>
              <td>{{item.createTime}}</td>
              <td>{{item.queCourse}}</td>
              <td>{{item.clickCount}}</td>
              <td>{{item.praiseCount}}</td>
              <td>{{item.replyCount}}</td>
              <td>
                <button *ngIf="item.userId === 'admin'" nz-button nzType="primary" (click)="updateInfo(item)">编辑</button>
                <button *ngIf="item.userId !== 'admin'" nz-button nzType="primary" (click)="Detail(item)">查看</button>
                <button nz-button nzType="danger" (click)="deteleInfo(item)">删除</button>
              </td>
            </tr>
          </tbody>
        </nz-table>
      </div>
    </div>
  </div>
</div>

<!-- 修改 -->
<nz-modal [(nzVisible)]="isVisibleUpdate" nzTitle="修改帖子信息" (nzOnCancel)="handleCancel()" (nzOnOk)="handleUpdate()">
    <div class="content-model">
      <table>
        <tr>
          <td width="150"><nz-form-label>编号</nz-form-label></td>
          <td><input nz-input placeholder="编号" [(ngModel)]="question.id" disabled></td>
        </tr>
        <tr>
          <td width="150"><nz-form-label>主题</nz-form-label></td>
          <td><input nz-input placeholder="主题" [(ngModel)]="question.title"></td>
        </tr>
        <tr>
          <td width="150"><nz-form-label>内容</nz-form-label></td>
          <td><textarea style="width: 400px;height: 500px;" rows="2" nz-input [(ngModel)]="question.detail"></textarea></td>
        </tr>
        <tr>
         <td width="150"><nz-form-label>创建人</nz-form-label></td>
         <td><input nz-input placeholder="创建人" [(ngModel)]="question.userID" disabled></td>
       </tr>
        <tr>
          <td width="150"><nz-form-label>隶属课程</nz-form-label></td>
          <td><input nz-input placeholder="隶属课程" [(ngModel)]="question.course"></td>
        </tr>
        <tr>
          <td width="150"><nz-form-label>图片</nz-form-label></td>
          <td>
            <img *ngIf="question.src !== ' ' && question.src !== undefined" style="width: 40px;height: 40px;" [src]="question.src">
            <nz-upload
              class="avatar-uploader"
              nzAction="http://127.0.0.1:8080/forum/file/upload"
              nzName="files"
              nzListType="picture-card"
              [nzShowUploadList]="false"
              [nzBeforeUpload]="beforeUpload"
              (nzChange)="handleChange($event)"
            >
              <ng-container *ngIf="!avatarUrl">
                <i class="upload-icon" nz-icon [type]="loading ? 'loading' : 'plus'"></i>
                <div class="ant-upload-text">Upload</div>
              </ng-container>
              <img *ngIf="avatarUrl" style="width: 40px;height: 40px;" [src]="avatarUrl" class="avatar" />
            </nz-upload>
          </td>
        </tr>
      </table>
    </div>
  </nz-modal>
